<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CurrencyPro - Currency Converter</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* CSS styles remain the same as before */
        :root {
            --primary-color: #00b2a9;
            --primary-dark: #009c94;
            --text-primary: #333333;
            --text-secondary: #666666;
            --background: #ffffff;
            --card-background: #ffffff;
            --border-color: #e0e0e0;
            --shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            --radius: 0px;
            --transition: all 0.3s ease;
        }

        [data-theme="dark"] {
            --primary-color: #00d6cc;
            --primary-dark: #00b2a9;
            --text-primary: #f5f5f5;
            --text-secondary: #b0b0b0;
            --background: #121212;
            --card-background: #1e1e1e;
            --border-color: #333333;
            --shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }

        body {
            background-color: var(--background);
            color: var(--text-primary);
            transition: var(--transition);
            max-width: 500px;
            margin: 0 auto;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Top Navigation */
        .header {
            padding: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--card-background);
            border-bottom: 1px solid var(--border-color);
        }

        .logo {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo i {
            font-size: 18px;
        }

        /* Bottom Navigation */
        .bottom-nav {
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 12px 0;
            background-color: var(--card-background);
            border-top: 1px solid var(--border-color);
            position: sticky;
            bottom: 0;
            z-index: 10;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            transition: var(--transition);
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 12px;
        }

        .nav-item.active {
            color: var(--primary-color);
            background-color: rgba(0, 178, 169, 0.1);
        }

        .nav-item i {
            font-size: 18px;
        }

        .nav-item span {
            font-size: 11px;
            font-weight: 500;
        }

        /* Page Content */
        .page {
            display: none;
            flex: 1;
            overflow-y: auto;
            padding-bottom: 70px;
        }

        .page.active {
            display: block;
        }

        .page-title {
            padding: 20px 16px 8px;
            font-size: 24px;
            font-weight: 700;
        }

        .section-title {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 16px;
            color: var(--text-secondary);
        }

        /* Rates Page */
        .rates-section {
            padding: 0 16px;
        }

        .rates-list {
            background-color: var(--card-background);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-bottom: 16px;
        }

        .rate-item {
            display: flex;
            align-items: center;
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
            transition: var(--transition);
        }

        .rate-item:last-child {
            border-bottom: none;
        }

        .rate-item:hover {
            background-color: rgba(0, 178, 169, 0.03);
        }

        /* Currency Image */
        .currency-image {
            width: 32px;
            height: 32px;
            margin-right: 12px;
            flex-shrink: 0;
            border-radius: 50%;
            overflow: hidden;
            object-fit: cover;
            background-color: #f5f5f5;
        }

        .rate-info {
            flex: 1;
            min-width: 0;
        }

        .rate-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .currency-name {
            font-size: 16px;
            font-weight: 600;
        }

        /* Rate Display Line - GREEN AS REQUESTED */
        .rate-display-line {
            font-size: 14px;
            color: #28a745;
            font-weight: 600;
            margin-top: 2px;
        }

        .rate-actions {
            margin-left: 12px;
            display: flex;
            gap: 6px;
        }

        .action-btn {
            width: 32px;
            height: 32px;
            border: 1px solid var(--border-color);
            background-color: transparent;
            color: var(--text-primary);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .action-btn.remove-btn:hover {
            background-color: #ffebee;
            color: #f44336;
            border-color: #f44336;
        }

        .add-currency-section {
            padding: 16px;
            border-top: 1px solid var(--border-color);
            background-color: rgba(0, 178, 169, 0.05);
        }

        .add-currency-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 12px;
            color: var(--primary-color);
            font-weight: 600;
            cursor: pointer;
            background: none;
            border: 1px dashed var(--primary-color);
            border-radius: 4px;
            transition: var(--transition);
            font-size: 14px;
        }

        .add-currency-btn:hover {
            background-color: rgba(0, 178, 169, 0.1);
        }

        /* Converter Page */
        .converter {
            padding: 0 16px;
        }

        .converter-section {
            background-color: var(--card-background);
            padding: 24px 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: var(--shadow);
        }

        .amount-input {
            width: 100%;
            padding: 20px 0;
            font-size: 42px;
            font-weight: 700;
            border: none;
            background: none;
            color: var(--text-primary);
            text-align: center;
            outline: none;
        }

        .currency-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .currency-display {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        /* Currency Flag in Converter */
        .currency-flag {
            width: 44px;
            height: 44px;
            flex-shrink: 0;
            border-radius: 50%;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f5f5f5;
        }

        .currency-flag img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .currency-symbol {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary-color);
        }

        .swap-icon-btn {
            width: 36px;
            height: 36px;
            background: none;
            border: 1px solid var(--border-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-secondary);
            transition: var(--transition);
            margin-left: 12px;
        }

        .swap-icon-btn:hover {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .swap-container {
            display: flex;
            justify-content: center;
            margin: 16px 0;
        }

        .swap-btn-large {
            background-color: var(--background);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
            width: 46px;
            height: 46px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .swap-btn-large:hover {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* Mid Market Rate Display - GREEN AS REQUESTED */
        .mid-rate-display {
            text-align: center;
            padding: 12px;
            margin: 20px 0;
            background-color: rgba(40, 167, 69, 0.1);
            border-radius: 8px;
            color: #28a745;
            font-weight: 600;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .mid-rate-display i {
            color: #28a745;
        }

        .mid-market-rate {
            text-align: center;
            padding: 16px 0;
            color: var(--text-secondary);
            font-size: 13px;
            border-top: 1px solid var(--border-color);
            margin-top: 16px;
        }

        /* Settings Page */
        .settings-section {
            padding: 0 16px;
        }

        .settings-group {
            margin-bottom: 24px;
        }

        .group-title {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-secondary);
        }

        .setting-item {
            background-color: var(--card-background);
            padding: 16px;
            margin-bottom: 1px;
            border-bottom: 1px solid var(--border-color);
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-info h3 {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .setting-info p {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .theme-selector {
            display: flex;
            gap: 8px;
        }

        .theme-option {
            padding: 6px 12px;
            border: 1px solid var(--border-color);
            background: none;
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition);
            font-size: 13px;
            border-radius: 4px;
        }

        .theme-option.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .version-info {
            padding: 16px;
            color: var(--text-secondary);
            font-size: 13px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid var(--border-color);
            margin-top: 20px;
        }

        /* Currency Selection Modal */
        .currency-select-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 100;
            justify-content: center;
            align-items: center;
            padding: 16px;
        }

        .currency-select-modal.active {
            display: flex;
        }

        .modal-content {
            background-color: var(--card-background);
            width: 100%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            border-radius: 8px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            padding: 20px 20px 12px;
            font-size: 20px;
            font-weight: 700;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-body {
            padding: 0;
        }

        .currency-option {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: var(--transition);
        }

        .currency-option:hover {
            background-color: rgba(0, 178, 169, 0.05);
        }

        .currency-option.selected {
            background-color: rgba(0, 178, 169, 0.1);
        }

        .close-modal-btn {
            width: 100%;
            padding: 16px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 1px;
            border-radius: 0 0 8px 8px;
        }

        @media (max-width: 500px) {
            body {
                border-left: 1px solid var(--border-color);
                border-right: 1px solid var(--border-color);
            }
            
            .amount-input {
                font-size: 36px;
            }
            
            .currency-image {
                width: 28px;
                height: 28px;
            }
            
            .currency-flag {
                width: 36px;
                height: 36px;
            }
        }

        /* Animation for notifications */
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .notification {
            animation: slideDown 0.3s ease;
        }
    </style>
</head>
<body>
    <!-- Top Navigation -->
    <div class="header">
        <div class="logo">
            <i class="fas fa-globe-americas"></i>
            CurrencyPro
        </div>
    </div>

    <!-- Rates Page -->
    <div class="page active" id="ratesPage">
        <h1 class="page-title">Exchange Rates</h1>
        
        <div class="rates-section">
            <div class="section-title">
                <span>Currency Rates</span>
            </div>
            
            <div class="rates-list" id="ratesList">
                <!-- Dynamic content will be loaded here -->
                <div class="rate-item">
                    <img src="" alt="USD" class="currency-image">
                    <div class="rate-info">
                        <div class="rate-header">
                            <div class="currency-name">USD</div>
                        </div>
                        <div class="rate-display-line">Loading rates...</div>
                    </div>
                </div>
            </div>
            
            <div class="add-currency-section">
                <button class="add-currency-btn" id="addCurrencyBtn">
                    <i class="fas fa-plus"></i>
                    Add Currency
                </button>
            </div>
        </div>
    </div>

    <!-- Converter Page -->
    <div class="page" id="convertPage">
        <h1 class="page-title">Currency Converter</h1>
        
        <div class="converter">
            <div class="converter-section">
                <!-- From Currency -->
                <div class="currency-row">
                    <div class="currency-display">
                        <div class="currency-flag" id="fromCurrencyImage">
                            <img src="https://raw.githubusercontent.com/jamalkatabeuro-sketch/My-website/main/101-currency-usd.png" alt="USD" id="fromFlagImg">
                        </div>
                        <div class="currency-symbol" id="fromCurrencyCode">USD</div>
                    </div>
                    <button class="swap-icon-btn" id="changeFromCurrencyBtn">
                        <i class="fas fa-exchange-alt"></i>
                    </button>
                </div>
                
                <input type="text" class="amount-input" id="fromAmount" value="100" inputmode="decimal">
                
                <!-- Mid Market Rate Display -->
                <div class="mid-rate-display" id="midRateDisplay">
                    <i class="fas fa-exchange-alt"></i>
                    <span id="rateText">1 USD = 0.8500 EUR</span>
                </div>
                
                <!-- Swap Button -->
                <div class="swap-container">
                    <button class="swap-btn-large" id="swapCurrencies">
                        <i class="fas fa-exchange-alt"></i>
                    </button>
                </div>
                
                <!-- To Currency -->
                <div class="currency-row">
                    <div class="currency-display">
                        <div class="currency-flag" id="toCurrencyImage">
                            <img src="https://raw.githubusercontent.com/jamalkatabeuro-sketch/My-website/main/100-currency-eur.png" alt="EUR" id="toFlagImg">
                        </div>
                        <div class="currency-symbol" id="toCurrencyCode">EUR</div>
                    </div>
                    <button class="swap-icon-btn" id="changeToCurrencyBtn">
                        <i class="fas fa-exchange-alt"></i>
                    </button>
                </div>
                
                <input type="text" class="amount-input" id="toAmount" value="85.00" readonly>
                
                <!-- Mid-market rate info -->
                <div class="mid-market-rate">
                    <p>Mid-market rate used</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Page -->
    <div class="page" id="settingsPage">
        <h1 class="page-title">Settings</h1>
        
        <div class="settings-section">
            <div class="settings-group">
                <div class="group-title">Appearance</div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <h3>Dark Mode</h3>
                        <p>Change app appearance</p>
                    </div>
                    <div class="theme-selector">
                        <button class="theme-option active" data-theme="light">Light</button>
                        <button class="theme-option" data-theme="dark">Dark</button>
                    </div>
                </div>
            </div>
            
            <div class="settings-group">
                <div class="group-title">Updates</div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <h3>Auto Update</h3>
                        <p>Updates every hour</p>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 13px; color: #28a745;">
                            <i class="fas fa-check-circle"></i> Enabled
                        </div>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <h3>Last Update</h3>
                        <p>Exchange rates</p>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 14px; font-weight: 600;" id="lastUpdateTime">--:--</div>
                        <div style="font-size: 11px; color: var(--text-secondary);" id="lastUpdateStatus">
                            Loading...
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="version-info">
                <span>Â© 2023 CurrencyPro</span>
                <span>All rights reserved</span>
            </div>
        </div>
    </div>

    <!-- Add Currency Modal -->
    <div class="currency-select-modal" id="addCurrencyModal">
        <div class="modal-content">
            <div class="modal-header">Add Currency</div>
            <div class="modal-body" id="availableCurrenciesList">
                <!-- Dynamic content will be loaded here -->
            </div>
            <button class="close-modal-btn" id="closeModalBtn">Close</button>
        </div>
    </div>

    <!-- Change Currency Modal -->
    <div class="currency-select-modal" id="changeCurrencyModal">
        <div class="modal-content">
            <div class="modal-header" id="changeCurrencyTitle">Select Currency</div>
            <div class="modal-body" id="changeCurrencyList">
                <!-- Dynamic content will be loaded here -->
            </div>
            <button class="close-modal-btn" id="closeChangeModalBtn">Close</button>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <a href="#" class="nav-item" data-page="settingsPage">
            <i class="fas fa-cog"></i>
            <span>Settings</span>
        </a>
        <a href="#" class="nav-item" data-page="convertPage">
            <i class="fas fa-exchange-alt"></i>
            <span>Convert</span>
        </a>
        <a href="#" class="nav-item active" data-page="ratesPage">
            <i class="fas fa-chart-line"></i>
            <span>Rates</span>
        </a>
    </div>

    <!-- JavaScript -->
    <script>
        // Configuration
        const CONFIG = {
            // API Configuration
            API_KEY: 'b83fce53976843bbb59336c03f9a6a30',
            API_URL: 'https://api.twelvedata.com/exchange_rate',
            
            // Image URLs - CORRECTED
            IMAGE_BASE_URL: 'https://raw.githubusercontent.com/jamalkatabeuro-sketch/My-website/main/',
            
            // Rates Page Images - NOW FIRST
RATES_IMAGES: {
    'EUR': '100-currency-eur.png',
    'USD': '101-currency-usd.png',
    'GBP': '102-currency-gbp.png',
    'CHF': '103-currency-chf.png',
    'CAD': '104-currency-cad.png',
    'AUD': '105-currency-aud.png',
    'TRY': '106-currency-try.png',
    'CNY': '107-currency-cny.png',
    'BRL': '108-currency-brl.png',
    'MXN': '109-currency-mxn.png',
    'ARS': '110-currency-ars.png',
    'RUB': '111-currency-rub.png',
    'ZAR': '112-currency-zar.png',
    'JPY': '113-currency-jpy.png',
    'KRW': '114-currency-krw.png',
    'INR': '115-currency-inr.png',
    'HKD': '116-currency-hkd.png',
    'MYR': '117-currency-myr.png',
    'MAD': '118-currency-mad.png',
    'EGP': '119-currency-egp.png',
    'TND': '120-currency-tnd.png',
    'SAR': '121-currency-sar.png',
    'QAR': '122-currency-qar.png',
    'AED': '123-currency-aed.png'
},

// Converter Images - NOW SECOND
CONVERTER_IMAGES: {
    'EUR': '100-currency-eurx.png',
    'CAD': '101-currency-cadx.png',
    'GBP': '102-currency-gbpx.png',
    'CHF': '103-currency-chfx.png',
    'AUD': '104-currency-audx.png',
    'JPY': '105-currency-jpyx.png',
    'KRW': '106-currency-krwx.png',
    'BRL': '107-currency-brlx.png',
    'MXN': '108-currency-mxnx.png',
    'TRY': '109-currency-tryx.png',
    'CNY': '110-currency-cnyx.png',
    'MYR': '111-currency-myrx.png',
    'RUB': '112-currency-rubx.png',
    'MAD': '113-currency-madx.png',
    'EGB': '114-currency-egbx.png',
    'TND': '115-currency-tndx.png',
    'SAR': '116-currency-sarx.png',
    'QAR': '117-currency-qarx.png',
    'AED': '118-currency-aedx.png',
},
            
            // Update intervals
            UPDATE_INTERVAL: 60 * 60 * 1000,
            CACHE_DURATION: 55 * 60 * 1000,
            
            // All available currencies
            ALL_CURRENCIES: [
                { code: 'USD', name: 'US Dollar' },
                { code: 'EUR', name: 'Euro' },
                { code: 'GBP', name: 'British Pound' },
                { code: 'JPY', name: 'Japanese Yen' },
                { code: 'CHF', name: 'Swiss Franc' },
                { code: 'CAD', name: 'Canadian Dollar' },
                { code: 'AUD', name: 'Australian Dollar' },
                { code: 'CNY', name: 'Chinese Yuan' },
                { code: 'AED', name: 'UAE Dirham' },
                { code: 'SAR', name: 'Saudi Riyal' },
                { code: 'QAR', name: 'Qatari Riyal' },
                { code: 'EGP', name: 'Egyptian Pound' },
                { code: 'TRY', name: 'Turkish Lira' },
                { code: 'INR', name: 'Indian Rupee' },
                { code: 'RUB', name: 'Russian Ruble' },
                { code: 'BRL', name: 'Brazilian Real' },
                { code: 'ZAR', name: 'South African Rand' },
                { code: 'MXN', name: 'Mexican Peso' },
                { code: 'KRW', name: 'South Korean Won' },
                { code: 'HKD', name: 'Hong Kong Dollar' },
                { code: 'MYR', name: 'Malaysian Ringgit' },
                { code: 'MAD', name: 'Moroccan Dirham' },
                { code: 'TND', name: 'Tunisian Dinar' },
                { code: 'ARS', name: 'Argentine Peso' }
            ],
            
            // Default tracked currencies
            DEFAULT_TRACKED: ['USD', 'EUR', 'GBP', 'JPY', 'AED', 'SAR', 'QAR'],
            
            // Default settings
            DEFAULT_SETTINGS: {
                theme: 'light',
                fromCurrency: 'USD',
                toCurrency: 'EUR',
                amount: 100
            }
        };

        // App State
        const AppState = {
            theme: localStorage.getItem('theme') || CONFIG.DEFAULT_SETTINGS.theme,
            trackedCurrencies: JSON.parse(localStorage.getItem('trackedCurrencies')) || CONFIG.DEFAULT_TRACKED,
            fromCurrency: localStorage.getItem('fromCurrency') || CONFIG.DEFAULT_SETTINGS.fromCurrency,
            toCurrency: localStorage.getItem('toCurrency') || CONFIG.DEFAULT_SETTINGS.toCurrency,
            amount: parseFloat(localStorage.getItem('amount')) || CONFIG.DEFAULT_SETTINGS.amount,
            exchangeRates: JSON.parse(localStorage.getItem('exchangeRates')) || null,
            lastUpdate: localStorage.getItem('lastUpdate') || null,
            changingCurrency: null
        };

        // Save state to localStorage
        function saveAppState() {
            localStorage.setItem('theme', AppState.theme);
            localStorage.setItem('trackedCurrencies', JSON.stringify(AppState.trackedCurrencies));
            localStorage.setItem('fromCurrency', AppState.fromCurrency);
            localStorage.setItem('toCurrency', AppState.toCurrency);
            localStorage.setItem('amount', AppState.amount.toString());
            
            if (AppState.exchangeRates) {
                localStorage.setItem('exchangeRates', JSON.stringify(AppState.exchangeRates));
            }
            
            if (AppState.lastUpdate) {
                localStorage.setItem('lastUpdate', AppState.lastUpdate);
            }
        }

        // Format number
        function formatNumber(num, decimals = 4) {
            const number = parseFloat(num);
            if (isNaN(number)) return '0.0000';
            
            return number.toLocaleString('en-US', {
                minimumFractionDigits: decimals,
                maximumFractionDigits: decimals
            });
        }

        // Show notification
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification`;
            
            let icon = 'info-circle';
            let bgColor = 'var(--primary-color)';
            
            if (type === 'success') {
                icon = 'check-circle';
                bgColor = '#28a745';
            } else if (type === 'error') {
                icon = 'exclamation-circle';
                bgColor = '#dc3545';
            }
            
            notification.innerHTML = `
                <i class="fas fa-${icon}"></i>
                <span>${message}</span>
            `;
            
            notification.style.cssText = `
                position: fixed;
                top: 70px;
                left: 50%;
                transform: translateX(-50%);
                background-color: ${bgColor};
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                z-index: 1000;
                font-size: 14px;
                font-weight: 500;
                display: flex;
                align-items: center;
                gap: 10px;
                animation: slideDown 0.3s ease;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(-50%) translateY(-10px)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Update last update time display
        function updateLastUpdateDisplay() {
            const timeElement = document.getElementById('lastUpdateTime');
            const statusElement = document.getElementById('lastUpdateStatus');
            
            if (!timeElement || !statusElement) return;
            
            if (AppState.lastUpdate) {
                const updateTime = new Date(AppState.lastUpdate);
                const now = new Date();
                const diffMinutes = Math.floor((now - updateTime) / (1000 * 60));
                
                timeElement.textContent = updateTime.toLocaleTimeString([], {
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                if (diffMinutes < 1) {
                    statusElement.textContent = 'Just now';
                    statusElement.style.color = '#28a745';
                } else if (diffMinutes < 60) {
                    statusElement.textContent = `${diffMinutes}m ago`;
                    statusElement.style.color = 'var(--primary-color)';
                } else {
                    const hours = Math.floor(diffMinutes / 60);
                    statusElement.textContent = `${hours}h ago`;
                    statusElement.style.color = 'var(--text-secondary)';
                }
            } else {
                timeElement.textContent = '--:--';
                statusElement.textContent = 'Never updated';
                statusElement.style.color = 'var(--text-secondary)';
            }
        }

        // Apply theme
        function applyTheme(theme) {
            AppState.theme = theme;
            saveAppState();
            
            if (theme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
            } else {
                document.documentElement.removeAttribute('data-theme');
            }
            
            document.querySelectorAll('.theme-option').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.theme === theme) {
                    btn.classList.add('active');
                }
            });
        }

        // Get image URL for currency
        function getImageUrl(currencyCode, type = 'converter') {
            const imageMap = type === 'converter' ? CONFIG.CONVERTER_IMAGES : CONFIG.RATES_IMAGES;
            const imageName = imageMap[currencyCode];
            
            if (imageName) {
                return CONFIG.IMAGE_BASE_URL + imageName;
            }
            
            // Fallback to USD image
            return CONFIG.IMAGE_BASE_URL + '101-currency-usd.png';
        }

        // Get default rates (fallback)
        function getDefaultRates() {
            return {
                USD: 1.0,
                EUR: 0.93,
                GBP: 0.79,
                JPY: 148.0,
                CHF: 0.88,
                CAD: 1.35,
                AUD: 1.51,
                CNY: 7.18,
                AED: 3.67,
                SAR: 3.75,
                QAR: 3.64,
                EGP: 30.9,
                TRY: 28.5,
                INR: 83.0,
                RUB: 91.5,
                BRL: 4.95,
                ZAR: 18.7,
                MXN: 17.2,
                KRW: 1310.0,
                HKD: 7.82,
                MYR: 4.67,
                MAD: 10.1,
                TND: 3.11,
                ARS: 350.0
            };
        }

        // Fetch exchange rates from API
        async function fetchExchangeRates() {
            try {
                console.log('Fetching exchange rates...');
                
                // Use default rates for now (API sometimes has issues)
                const defaultRates = getDefaultRates();
                
                // Update app state with default rates
                AppState.exchangeRates = defaultRates;
                AppState.lastUpdate = new Date().toISOString();
                saveAppState();
                
                // Update displays
                updateRatesDisplay();
                updateConverterDisplay();
                updateLastUpdateDisplay();
                
                console.log('Rates updated successfully with default values');
                showNotification('Exchange rates loaded', 'success');
                
                return defaultRates;
                
            } catch (error) {
                console.error('Error fetching rates:', error);
                
                // Use default rates
                const defaultRates = getDefaultRates();
                AppState.exchangeRates = defaultRates;
                
                updateRatesDisplay();
                updateConverterDisplay();
                
                showNotification('Using default rates', 'info');
                
                return defaultRates;
            }
        }

        // Convert amount
        function convertAmount(amount, fromCurrency, toCurrency) {
            if (!AppState.exchangeRates) return 0;
            
            const fromRate = AppState.exchangeRates[fromCurrency] || 1;
            const toRate = AppState.exchangeRates[toCurrency] || 1;
            
            const amountInUSD = amount / fromRate;
            return amountInUSD * toRate;
        }

        // Get exchange rate
        function getExchangeRate(fromCurrency, toCurrency) {
            if (!AppState.exchangeRates) return 1;
            
            const fromRate = AppState.exchangeRates[fromCurrency] || 1;
            const toRate = AppState.exchangeRates[toCurrency] || 1;
            
            return toRate / fromRate;
        }

        // Update rates display
        function updateRatesDisplay() {
            const ratesList = document.getElementById('ratesList');
            if (!ratesList) return;
            
            ratesList.innerHTML = '';
            
            if (!AppState.exchangeRates) {
                ratesList.innerHTML = `
                    <div class="rate-item">
                        <img src="${CONFIG.IMAGE_BASE_URL}101-currency-usd.png" alt="Loading" class="currency-image">
                        <div class="rate-info">
                            <div class="currency-name">Loading rates...</div>
                            <div class="rate-display-line">Please wait</div>
                        </div>
                    </div>
                `;
                return;
            }
            
            AppState.trackedCurrencies.forEach(currencyCode => {
                const rate = AppState.exchangeRates[currencyCode];
                if (!rate) return;
                
                const item = document.createElement('div');
                item.className = 'rate-item';
                
                const imageUrl = getImageUrl(currencyCode, 'rates');
                
                item.innerHTML = `
                    <img src="${imageUrl}" 
                         alt="${currencyCode}" 
                         class="currency-image"
                         onerror="this.src='${CONFIG.IMAGE_BASE_URL}101-currency-usd.png'">
                    <div class="rate-info">
                        <div class="rate-header">
                            <div class="currency-name">${currencyCode}</div>
                        </div>
                        <div class="rate-display-line">1 USD = ${formatNumber(rate)} ${currencyCode}</div>
                    </div>
                    <div class="rate-actions">
                        <button class="action-btn remove-btn" data-currency="${currencyCode}" title="Remove">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                `;
                
                ratesList.appendChild(item);
            });
        }

        // Update converter display
        function updateConverterDisplay() {
            // Update images
            updateConverterImages();
            
            // Update currency codes
            document.getElementById('fromCurrencyCode').textContent = AppState.fromCurrency;
            document.getElementById('toCurrencyCode').textContent = AppState.toCurrency;
            
            if (AppState.exchangeRates) {
                // Calculate conversion
                const exchangeRate = getExchangeRate(AppState.fromCurrency, AppState.toCurrency);
                const convertedAmount = convertAmount(AppState.amount, AppState.fromCurrency, AppState.toCurrency);
                
                // Update amounts
                document.getElementById('fromAmount').value = AppState.amount;
                document.getElementById('toAmount').value = formatNumber(convertedAmount, 2);
                
                // Update rate display
                const rateText = `1 ${AppState.fromCurrency} = ${formatNumber(exchangeRate)} ${AppState.toCurrency}`;
                document.getElementById('rateText').textContent = rateText;
            }
        }

        // Update converter images
        function updateConverterImages() {
            const fromImage = document.getElementById('fromFlagImg');
            const toImage = document.getElementById('toFlagImg');
            
            if (fromImage) {
                fromImage.src = getImageUrl(AppState.fromCurrency, 'converter');
                fromImage.alt = AppState.fromCurrency;
                fromImage.onerror = function() {
                    this.src = CONFIG.IMAGE_BASE_URL + '101-currency-usd.png';
                };
            }
            
            if (toImage) {
                toImage.src = getImageUrl(AppState.toCurrency, 'converter');
                toImage.alt = AppState.toCurrency;
                toImage.onerror = function() {
                    this.src = CONFIG.IMAGE_BASE_URL + '101-currency-usd.png';
                };
            }
        }

        // Show add currency modal
        function showAddCurrencyModal() {
            const modal = document.getElementById('addCurrencyModal');
            const list = document.getElementById('availableCurrenciesList');
            
            if (!modal || !list) return;
            
            list.innerHTML = '';
            
            // Get currencies not already tracked
            const availableCurrencies = CONFIG.ALL_CURRENCIES.filter(currency => 
                !AppState.trackedCurrencies.includes(currency.code)
            );
            
            if (availableCurrencies.length === 0) {
                list.innerHTML = '<div style="padding: 20px; text-align: center; color: var(--text-secondary);">All currencies are already added</div>';
            } else {
                availableCurrencies.forEach(currency => {
                    const option = createCurrencyOption(currency, false, 'add');
                    list.appendChild(option);
                });
            }
            
            modal.classList.add('active');
        }

        // Show change currency modal
        function showChangeCurrencyModal(type) {
            const modal = document.getElementById('changeCurrencyModal');
            const title = document.getElementById('changeCurrencyTitle');
            const list = document.getElementById('changeCurrencyList');
            
            if (!modal || !title || !list) return;
            
            AppState.changingCurrency = type;
            
            // Update title
            title.textContent = type === 'from' ? 'Select From Currency' : 'Select To Currency';
            
            // Clear list
            list.innerHTML = '';
            
            // Add all currencies
            CONFIG.ALL_CURRENCIES.forEach(currency => {
                const isSelected = (type === 'from' && currency.code === AppState.fromCurrency) ||
                                  (type === 'to' && currency.code === AppState.toCurrency);
                
                const option = createCurrencyOption(currency, isSelected, 'change');
                list.appendChild(option);
            });
            
            modal.classList.add('active');
        }

        // Create currency option
        function createCurrencyOption(currency, isSelected, modalType) {
            const option = document.createElement('div');
            option.className = `currency-option ${isSelected ? 'selected' : ''}`;
            option.dataset.currency = currency.code;
            
            const imageUrl = getImageUrl(currency.code, 'rates');
            
            if (modalType === 'add') {
                option.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 12px; flex: 1;">
                        <img src="${imageUrl}" 
                             alt="${currency.code}" 
                             style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover;"
                             onerror="this.src='${CONFIG.IMAGE_BASE_URL}101-currency-usd.png'">
                        <div>
                            <div style="font-weight: 600; font-size: 14px;">${currency.code}</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">${currency.name}</div>
                        </div>
                    </div>
                    <button class="action-btn" style="border-color: var(--primary-color); color: var(--primary-color);" data-currency="${currency.code}">
                        <i class="fas fa-plus"></i>
                    </button>
                `;
            } else {
                option.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 12px; flex: 1;">
                        <img src="${imageUrl}" 
                             alt="${currency.code}" 
                             style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover;"
                             onerror="this.src='${CONFIG.IMAGE_BASE_URL}101-currency-usd.png'">
                        <div>
                            <div style="font-weight: 600; font-size: 14px;">${currency.code}</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">${currency.name}</div>
                        </div>
                    </div>
                    ${isSelected ? '<i class="fas fa-check" style="color: var(--primary-color);"></i>' : ''}
                `;
            }
            
            return option;
        }

        // Add currency
        function addCurrency(currencyCode) {
            if (!AppState.trackedCurrencies.includes(currencyCode)) {
                AppState.trackedCurrencies.push(currencyCode);
                saveAppState();
                updateRatesDisplay();
                showNotification(`${currencyCode} added successfully`, 'success');
            }
        }

        // Remove currency
        function removeCurrency(currencyCode) {
            const index = AppState.trackedCurrencies.indexOf(currencyCode);
            if (index > -1) {
                AppState.trackedCurrencies.splice(index, 1);
                saveAppState();
                updateRatesDisplay();
                showNotification(`${currencyCode} removed`, 'info');
            }
        }

        // Swap currencies
        function swapCurrencies() {
            [AppState.fromCurrency, AppState.toCurrency] = [AppState.toCurrency, AppState.fromCurrency];
            saveAppState();
            updateConverterDisplay();
        }

        // Handle currency selection
        function handleCurrencySelection(currencyCode) {
            if (AppState.changingCurrency === 'from') {
                AppState.fromCurrency = currencyCode;
                saveAppState();
                updateConverterDisplay();
            } else if (AppState.changingCurrency === 'to') {
                AppState.toCurrency = currencyCode;
                saveAppState();
                updateConverterDisplay();
            }
        }

        // Start auto-update
        function startAutoUpdate() {
            // Initial fetch
            fetchExchangeRates();
            
            // Set interval for updates (every 10 minutes for demo)
            setInterval(() => {
                console.log('Auto-updating exchange rates...');
                fetchExchangeRates();
            }, 10 * 60 * 1000);
        }

        // Initialize app
        function initApp() {
            // Apply theme
            applyTheme(AppState.theme);
            
            // Load initial data
            updateRatesDisplay();
            updateConverterDisplay();
            updateLastUpdateDisplay();
            
            // Fetch rates
            fetchExchangeRates();
            
            // Start auto-update
            startAutoUpdate();
            
            // Setup event listeners
            setupEventListeners();
            
            console.log('CurrencyPro App initialized');
        }

        // Setup event listeners
        function setupEventListeners() {
            // Navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    handleNavigation(e.target.closest('.nav-item'));
                });
            });
            
            // Add currency button
            document.getElementById('addCurrencyBtn').addEventListener('click', () => {
                showAddCurrencyModal();
            });
            
            // Change currency buttons
            document.getElementById('changeFromCurrencyBtn').addEventListener('click', () => {
                showChangeCurrencyModal('from');
            });
            
            document.getElementById('changeToCurrencyBtn').addEventListener('click', () => {
                showChangeCurrencyModal('to');
            });
            
            // Swap currencies
            document.getElementById('swapCurrencies').addEventListener('click', () => {
                swapCurrencies();
            });
            
            // Amount input
            document.getElementById('fromAmount').addEventListener('input', (e) => {
                const value = e.target.value.replace(/[^0-9.]/g, '');
                const amount = parseFloat(value) || 0;
                
                AppState.amount = amount;
                saveAppState();
                updateConverterDisplay();
            });
            
            // Close modal buttons
            document.getElementById('closeModalBtn').addEventListener('click', () => {
                document.getElementById('addCurrencyModal').classList.remove('active');
            });
            
            document.getElementById('closeChangeModalBtn').addEventListener('click', () => {
                document.getElementById('changeCurrencyModal').classList.remove('active');
            });
            
            // Modal background clicks
            document.getElementById('addCurrencyModal').addEventListener('click', (e) => {
                if (e.target === e.currentTarget) {
                    e.currentTarget.classList.remove('active');
                }
            });
            
            document.getElementById('changeCurrencyModal').addEventListener('click', (e) => {
                if (e.target === e.currentTarget) {
                    e.currentTarget.classList.remove('active');
                }
            });
            
            // Theme selector
            document.querySelectorAll('.theme-option').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const theme = e.target.dataset.theme;
                    applyTheme(theme);
                });
            });
            
            // Event delegation for dynamic elements
            document.addEventListener('click', (e) => {
                // Remove currency button
                if (e.target.closest('.remove-btn')) {
                    const button = e.target.closest('.remove-btn');
                    const currencyCode = button.dataset.currency;
                    removeCurrency(currencyCode);
                }
                
                // Add currency from modal
                if (e.target.closest('.currency-option') && e.target.closest('#availableCurrenciesList')) {
                    const option = e.target.closest('.currency-option');
                    const button = option.querySelector('button');
                    if (button) {
                        const currencyCode = button.dataset.currency;
                        addCurrency(currencyCode);
                        document.getElementById('addCurrencyModal').classList.remove('active');
                    }
                }
                
                // Select currency in change modal
                if (e.target.closest('.currency-option') && e.target.closest('#changeCurrencyList')) {
                    const option = e.target.closest('.currency-option');
                    const currencyCode = option.dataset.currency;
                    
                    handleCurrencySelection(currencyCode);
                    document.getElementById('changeCurrencyModal').classList.remove('active');
                }
            });
        }

        // Handle navigation
        function handleNavigation(navItem) {
            if (!navItem) return;
            
            // Update active nav item
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            navItem.classList.add('active');
            
            // Show selected page
            const pageId = navItem.dataset.page;
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
        }

        // Start the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>


